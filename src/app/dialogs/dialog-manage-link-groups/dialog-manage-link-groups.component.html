<mat-dialog-content style="display: flex; flex-direction: column; height: 100%; position: relative;">
  <h3 mat-dialog-title class="pb-2">Manage Groups</h3>

      <i
      class="bi bi-x-lg close-icon"
      title="Close"
      (click)="closeDialog()"
    ></i>
  <div class="mb-2">
    <label for="linkGroupDropdown">Select Category</label>
     <select
     id="linkGroupDropdown"
     class="form-select mb-2"
     [(ngModel)]="selectedCategoryId"
     (change)="onCategoryChange($event)">
     <option *ngFor="let cat of categories" [value]="cat.id">{{ cat.name }}</option>
     </select>
  </div>
  <!-- [+] Add New Link Group (when hidden) -->
  <div *ngIf="!showAddLinkGroup" class="mt-1 mb-3">
     <span style="cursor: pointer;" (click)="showAddLinkGroup = true">&nbsp;[+] Add New Link Group</span>
  </div>


  <!-- Input + Close button (when visible) -->

  <div *ngIf="showAddLinkGroup">
   <form (ngSubmit)="addGroup()">
     <div class="input-group mb-4 mt-2">
       <input
       autocomplete="off"
         type="text"
         class="form-control"
         id="addLinkGroup"
         #groupInput
         [(ngModel)]="newGroupName"
         name="newGroupName"
         placeholder="Add New Link Group"
       />
 
       <button
         class="btn btn-outline-secondary"
         type="button"
         (click)="showAddLinkGroup = false; newGroupName = ''">
         âœ•
       </button>
 
       <button
         class="btn btn-outline-secondary"
         type="submit"
         [disabled]="!newGroupName.trim() || !selectedCategoryId">
         Add Group
       </button>
     </div>
   </form>
 </div>

 <div *ngIf="editableGroups.length === 0" class="text-muted mb-3 ps-1">
  No groups yet. Click <strong>"Add New Link Group"</strong> to add one.
</div>
 
  <div cdkDropList (cdkDropListDropped)="drop($event)" style="flex: 1; overflow-y: auto; padding-right: 8px; min-height: 0;">
     <div *ngFor="let group of editableGroups"
     #groupRow
     [attr.id]="'group-' + group.id"
     cdkDrag 
     class="category-row" 
     style="align-items: center; display: flex; gap: 10px;"
     [class.cdk-drag-animating]="true">
     <span cdkDragHandle style="cursor: grab;">
     <i class="bi bi-list" style="font-size: 1.2rem;"></i>
     </span>
     <i class="bi bi-pencil" (click)="enableEdit(group)" *ngIf="!group.isEditing" style="cursor: pointer;"></i>
     <span *ngIf="!group.isEditing">{{ group.name }}</span>
     <span style="flex: 1 1 auto;"></span>
     <div class="input-group mb-3 mt-3" *ngIf="group.isEditing">
        <input type="text" class="form-control" autocomplete="off" [(ngModel)]="group.name">
        <button class="btn btn-outline-secondary" type="button" (click)="cancelEdit(group)">Cancel</button>
        <button class="btn btn-outline-secondary" type="button" (click)="saveEdit(group)">Save</button>
     </div>
     <i class="bi bi-x-lg" (click)="deleteGroup(group)" *ngIf="!group.isEditing" style="color: red; cursor: pointer;"></i>
  </div>
  </div>
</mat-dialog-content>
<mat-dialog-actions>
  <button mat-flat-button (click)="saveOrder()" [disabled]="!hasOrderChanged">Save Order</button>
  <button mat-button (click)="closeDialog()">Close</button>
</mat-dialog-actions>