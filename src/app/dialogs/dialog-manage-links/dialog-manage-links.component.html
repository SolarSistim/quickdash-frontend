<mat-dialog-content style="display: flex; flex-direction: column; height: 100%; position: relative;">
  <h3 mat-dialog-title class="pb-2">Manage Links</h3>

      <i
      class="bi bi-x-lg close-icon"
      title="Close"
      (click)="closeDialog()"
    ></i>
  
  <div class="row">
    <div class="col-lg-6">

    <!-- Select Category -->
    <label>Select Category</label>
    <select class="form-select mb-2" [(ngModel)]="selectedCategoryId" (change)="onCategoryChange()">
      <option *ngFor="let cat of categories" [value]="cat.id">{{ cat.name }}</option>
    </select>

    </div>
    <div class="col-lg-6">
    <!-- Select Group -->
    <label>Select Group</label>
    <select
      class="form-select mb-3"
      [(ngModel)]="selectedGroupId"
      (ngModelChange)="selectedGroupId = +$event; onGroupChange()"
    >
      <option *ngFor="let group of filteredGroups" [value]="group.id">
        {{ group.name }}
      </option>
    </select>

  </div></div>

  <div *ngIf="showGroupEditor">
  <label for="groupName" >&nbsp;Group Name</label>
  <div class="input-group mb-4 mt-0">
    
    <input
    autocomplete="off"
      type="text"
      id="groupName"
      class="form-control"
      [(ngModel)]="groupName"
      placeholder="Group Name"
    />
    <button
      class="btn btn-outline-secondary"
      type="button"
      id="button-addon2"
      (click)="saveGroupName()"
      [disabled]="groupName.trim() === originalGroupName.trim() || !groupName.trim()"
    >
      Save
    </button>
  </div>
</div>

  <div *ngIf="showAddForm" style="margin-bottom: 20px;">
    <form (ngSubmit)="addLink()">
      <div class="input-group mb-1 mt-2">
        <input
        autocomplete="off"
          #linkNameInput
          type="text"
          class="form-control"
          name="newLinkName"
          placeholder="Display Name"
          [(ngModel)]="newLinkName"
        />
        <input
        autocomplete="off"
          type="text"
          class="form-control"
          name="newLinkUrl"
          placeholder="URL"
          [(ngModel)]="newLinkUrl"
        />
      </div>
  
      <div class="input-group mb-1 mt-2">
        <input
        autocomplete="off"
          type="text"
          class="form-control"
          name="newLinkDescription"
          placeholder="Link Description"
          [(ngModel)]="newLinkDescription"
        />
        <button class="btn btn-outline-secondary" type="button" (click)="cancelAddLink()">
          âœ•
        </button>
        <button
          class="btn btn-outline-secondary"
          type="submit"
          [disabled]="!newLinkName.trim() || !newLinkUrl.trim()"
        >
          Add Link
        </button>
      </div>
    </form>
  </div>
  

  <div *ngIf="!showAddForm" class="mt-1 mb-3">
    <span style="cursor: pointer;" (click)="showAddForm = true">&nbsp;[+] Add New Link Here</span>
 </div>

 <div *ngIf="editableLinks.length === 0" class="text-muted mb-3 ps-1">
  No links yet. Click <strong>"Add New Link Here"</strong> to add one.
</div>
  
    <!-- Links List -->
    <div cdkDropList (cdkDropListDropped)="drop($event)" style="overflow-y: auto;">
      <div *ngFor="let link of editableLinks" 
           cdkDrag 
           class="category-row" 
           style="display: flex; align-items: center; gap: 10px;">
        
        <span cdkDragHandle><i class="bi bi-list" style="font-size: 1.2rem;"></i></span>
        
        <div *ngIf="!link.isEditing" style="display: flex; align-items: center; width: 100%;">
          <i class="bi bi-pencil" (click)="enableEdit(link)" style="cursor: pointer; margin-right: 8px;"></i>
          <span>{{ link.name }}</span>
          <span style="flex: 1 1 auto;"></span>
          <i class="bi bi-x-lg" style="color: red; cursor: pointer;" (click)="deleteLink(link)"></i>
        </div>

        <div *ngIf="link.isEditing" class="w-100 mt-2">
          <label for="linkName">&nbsp;Link Name</label>
          <input class="form-control mb-1" autocomplete="off" [(ngModel)]="link.name" placeholder="Name" id="linkName"/>
          <label autocomplete="off" for="linkUrl">&nbsp;Link URL</label>
          <input autocomplete="off" class="form-control mb-1" [(ngModel)]="link.url" placeholder="URL" id="linkUrl"/>
          <label for="linkDescription">&nbsp;Link Description</label>
        <div class="input-group mb-2" style="flex-wrap: wrap;">
          <input autocomplete="off" class="form-control" [(ngModel)]="link.description" placeholder="Description" id="linkDescription"/>
            <button class="btn btn-outline-secondary" (click)="cancelEdit(link)">Cancel</button>
            <button class="btn btn-outline-secondary" (click)="saveEdit(link)">Save</button>
          </div>
      </div>

      
      </div>
    </div>
  </mat-dialog-content>
  
  <mat-dialog-actions>
    <button mat-flat-button (click)="saveOrder()" [disabled]="!hasOrderChanged">Save Order</button>
    <button mat-button (click)="closeDialog()">Close</button>
  </mat-dialog-actions>
  